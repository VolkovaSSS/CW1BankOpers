import pandas as pd
import pytest


@pytest.fixture
def test_transactions():
    return [
        {
            "Дата операции": "23.11.2021 18:15:54",
            "Дата платежа": "23.11.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -10.33,
            "Сумма платежа": -10.33,
            "Категория": "Каршеринг",
            "Описание": "Ситидрайв",
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 10.33,
        },
        {
            "Дата операции": "02.11.2021 08:06:23",
            "Дата платежа": "02.11.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -5510.8,
            "Сумма платежа": -5510.8,
            "Категория": "Аптеки",
            "Описание": "Ситидрайв",
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 5510.8,
        },
        {
            "Дата операции": "22.06.2020 17:28:50",
            "Дата платежа": "22.06.2020",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -1.07,
            "Сумма платежа": -1.07,
            "Категория": "Каршеринг",
            "Описание": "Ситидрайв",
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1.07,
        },
        {
            "Дата операции": "01.11.2021 13:34:22",
            "Дата платежа": "01.11.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": 1721.38,
            "Сумма платежа": 1721.38,
            "Категория": "Переводы",
            "Описание": "Ситидрайв",
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 1721.38,
        },
        {
            "Дата операции": "15.10.2021 12:10:47",
            "Дата платежа": "15.10.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -143.41,
            "Сумма платежа": -143.41,
            "Категория": "Каршеринг",
            "Описание": "Ситидрайв",
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 143.41,
        },
        {
            "Дата операции": "14.11.2021 14:26:10",
            "Дата платежа": "14.11.2021",
            "Номер карты": "*5091",
            "Статус": "OK",
            "Сумма операции": -95.09,
            "Сумма платежа": -95.09,
            "Категория": "Каршеринг",
            "Описание": "Ситидрайв",
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 95.09,
        },
        {
            "Дата операции": "30.11.2021 12:34:17",
            "Дата платежа": "30.11.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -95.09,
            "Сумма платежа": -95.09,
            "Категория": "Каршеринг",
            "Описание": "Ситидрайв",
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 95.09,
        },
    ]


@pytest.fixture
def test_transactions_views():
    df = pd.DataFrame(
        [
            {
                "Дата операции": "23.11.2021 18:15:54",
                "Дата платежа": "23.11.2021",
                "Номер карты": "*5091",
                "Статус": "OK",
                "Сумма операции": -10.33,
                "Сумма платежа": -10.33,
                "Категория": "Каршеринг",
                "Описание": "Ситидрайв",
                "Округление на инвесткопилку": 0,
                "Сумма операции с округлением": 10.33,
            },
            {
                "Дата операции": "02.11.2021 08:06:23",
                "Дата платежа": "02.11.2021",
                "Номер карты": "*5091",
                "Статус": "OK",
                "Сумма операции": -5510.8,
                "Сумма платежа": -5510.8,
                "Категория": "Аптеки",
                "Описание": "Ситидрайв",
                "Округление на инвесткопилку": 0,
                "Сумма операции с округлением": 5510.8,
            },
            {
                "Дата операции": "01.11.2021 13:34:22",
                "Дата платежа": "01.11.2021",
                "Номер карты": "*7197",
                "Статус": "OK",
                "Сумма операции": 1721.38,
                "Сумма платежа": 1721.38,
                "Категория": "Переводы",
                "Описание": "Ситидрайв",
                "Округление на инвесткопилку": 0,
                "Сумма операции с округлением": 1721.38,
            },
            {
                "Дата операции": "14.11.2021 14:26:10",
                "Дата платежа": "14.11.2021",
                "Номер карты": "*5091",
                "Статус": "OK",
                "Сумма операции": -95.09,
                "Сумма платежа": -95.09,
                "Категория": "Каршеринг",
                "Описание": "Ситидрайв",
                "Округление на инвесткопилку": 0,
                "Сумма операции с округлением": 95.09,
            },
        ]
    )
    df["Дата операции"] = pd.to_datetime(df["Дата операции"], dayfirst=True, format="%d.%m.%Y %H:%M:%S")
    return df
